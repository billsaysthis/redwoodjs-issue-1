# Migration `20200629144603-create-base-table-set`

This migration has been generated by Bill Lazar at 6/29/2020, 2:46:03 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
PRAGMA foreign_keys=OFF;

CREATE TABLE "quaint"."Address" (
"city" TEXT NOT NULL  ,"country" TEXT NOT NULL  ,"id" INTEGER NOT NULL  PRIMARY KEY AUTOINCREMENT,"state" TEXT NOT NULL  ,"street1" TEXT NOT NULL  ,"street2" TEXT   ,"zipcode" TEXT NOT NULL  )

CREATE TABLE "quaint"."RoleType" (
"id" INTEGER NOT NULL  PRIMARY KEY AUTOINCREMENT,"name" TEXT NOT NULL  )

CREATE TABLE "quaint"."Role" (
"clubChaperId" INTEGER NOT NULL  ,"id" INTEGER NOT NULL  PRIMARY KEY AUTOINCREMENT,"name" TEXT NOT NULL  ,"roleTypeId" INTEGER NOT NULL  ,"userId" INTEGER   ,FOREIGN KEY ("roleTypeId") REFERENCES "RoleType"("id") ON DELETE CASCADE ON UPDATE CASCADE,
FOREIGN KEY ("clubChaperId") REFERENCES "ClubChapter"("id") ON DELETE CASCADE ON UPDATE CASCADE,
FOREIGN KEY ("userId") REFERENCES "User"("id") ON DELETE SET NULL ON UPDATE CASCADE)

CREATE TABLE "quaint"."Media" (
"createdAt" DATE NOT NULL DEFAULT CURRENT_TIMESTAMP ,"createdById" INTEGER NOT NULL  ,"description" TEXT   ,"filename" TEXT NOT NULL  ,"filetype" TEXT NOT NULL  ,"id" INTEGER NOT NULL  PRIMARY KEY AUTOINCREMENT,"photoGalleryId" INTEGER   ,"updatedAt" DATE  DEFAULT CURRENT_TIMESTAMP ,"updatedById" INTEGER   ,FOREIGN KEY ("photoGalleryId") REFERENCES "PhotoGallery"("id") ON DELETE SET NULL ON UPDATE CASCADE)

CREATE TABLE "quaint"."PhotoGallery" (
"active" BOOLEAN NOT NULL DEFAULT true ,"clubChapterId" INTEGER NOT NULL  ,"createdAt" DATE NOT NULL DEFAULT CURRENT_TIMESTAMP ,"createdById" INTEGER NOT NULL  ,"deactivatedAt" DATE NOT NULL  ,"deactivatedById" INTEGER   ,"description" TEXT NOT NULL  ,"id" INTEGER NOT NULL  PRIMARY KEY AUTOINCREMENT,"name" TEXT NOT NULL  ,"updatedAt" DATE  DEFAULT CURRENT_TIMESTAMP ,"updatedById" INTEGER   ,FOREIGN KEY ("clubChapterId") REFERENCES "ClubChapter"("id") ON DELETE CASCADE ON UPDATE CASCADE)

CREATE TABLE "quaint"."Club" (
"createdAt" DATE NOT NULL DEFAULT CURRENT_TIMESTAMP ,"createdById" INTEGER NOT NULL  ,"email" TEXT NOT NULL  ,"id" INTEGER NOT NULL  PRIMARY KEY AUTOINCREMENT,"league" TEXT NOT NULL  ,"logoId" INTEGER   ,"name" TEXT NOT NULL  ,"updatedAt" DATE  DEFAULT CURRENT_TIMESTAMP ,"updatedById" INTEGER   ,FOREIGN KEY ("logoId") REFERENCES "Media"("id") ON DELETE SET NULL ON UPDATE CASCADE)

CREATE TABLE "quaint"."Officer" (
"clubChapterId" INTEGER   ,"createdAt" DATE NOT NULL DEFAULT CURRENT_TIMESTAMP ,"createdById" INTEGER NOT NULL  ,"id" INTEGER NOT NULL  PRIMARY KEY AUTOINCREMENT,"title" TEXT   ,"updatedAt" DATE  DEFAULT CURRENT_TIMESTAMP ,"updatedById" INTEGER   ,"userId" INTEGER NOT NULL  ,FOREIGN KEY ("userId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE,
FOREIGN KEY ("clubChapterId") REFERENCES "ClubChapter"("id") ON DELETE SET NULL ON UPDATE CASCADE)

CREATE TABLE "quaint"."ClubChapter" (
"active" BOOLEAN NOT NULL DEFAULT true ,"clubId" INTEGER NOT NULL  ,"createdAt" DATE NOT NULL DEFAULT CURRENT_TIMESTAMP ,"createdById" INTEGER NOT NULL  ,"deactivatedAt" DATE NOT NULL  ,"deactivatedById" INTEGER   ,"email" TEXT NOT NULL  ,"facebook" TEXT   ,"id" INTEGER NOT NULL  PRIMARY KEY AUTOINCREMENT,"instagram" TEXT   ,"logoId" INTEGER   ,"mailAddressId" INTEGER   ,"name" TEXT NOT NULL  ,"phone" TEXT   ,"twitter" TEXT   ,"updatedAt" DATE  DEFAULT CURRENT_TIMESTAMP ,"updatedById" INTEGER   ,"viewingAddressId" INTEGER   ,FOREIGN KEY ("clubId") REFERENCES "Club"("id") ON DELETE CASCADE ON UPDATE CASCADE,
FOREIGN KEY ("logoId") REFERENCES "Media"("id") ON DELETE SET NULL ON UPDATE CASCADE,
FOREIGN KEY ("mailAddressId") REFERENCES "Address"("id") ON DELETE SET NULL ON UPDATE CASCADE,
FOREIGN KEY ("viewingAddressId") REFERENCES "Address"("id") ON DELETE SET NULL ON UPDATE CASCADE)

CREATE TABLE "quaint"."User" (
"active" BOOLEAN NOT NULL DEFAULT true ,"addressId" INTEGER   ,"clubChapterId" INTEGER NOT NULL  ,"clubMembershipId" TEXT   ,"createdAt" DATE NOT NULL DEFAULT CURRENT_TIMESTAMP ,"deactivatedAt" DATE NOT NULL  ,"deactivatedById" INTEGER   ,"displayName" TEXT   ,"email" TEXT NOT NULL  ,"firstName" TEXT NOT NULL  ,"id" INTEGER NOT NULL  PRIMARY KEY AUTOINCREMENT,"imageId" INTEGER   ,"joinedAt" DATE NOT NULL  ,"lastName" TEXT NOT NULL  ,"phone" TEXT   ,"updatedAt" DATE NOT NULL DEFAULT CURRENT_TIMESTAMP ,FOREIGN KEY ("clubChapterId") REFERENCES "ClubChapter"("id") ON DELETE CASCADE ON UPDATE CASCADE,
FOREIGN KEY ("addressId") REFERENCES "Address"("id") ON DELETE SET NULL ON UPDATE CASCADE,
FOREIGN KEY ("imageId") REFERENCES "Media"("id") ON DELETE SET NULL ON UPDATE CASCADE)

CREATE TABLE "quaint"."Post" (
"authorId" INTEGER NOT NULL  ,"clubChapterId" INTEGER   ,"contentBody" TEXT NOT NULL  ,"createdAt" DATE NOT NULL DEFAULT CURRENT_TIMESTAMP ,"createdById" INTEGER NOT NULL  ,"id" INTEGER NOT NULL  PRIMARY KEY AUTOINCREMENT,"mediaId" INTEGER   ,"photoGalleryId" INTEGER   ,"title" TEXT NOT NULL  ,"updatedAt" DATE  DEFAULT CURRENT_TIMESTAMP ,"updatedById" INTEGER   ,FOREIGN KEY ("authorId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE,
FOREIGN KEY ("mediaId") REFERENCES "Media"("id") ON DELETE SET NULL ON UPDATE CASCADE,
FOREIGN KEY ("photoGalleryId") REFERENCES "PhotoGallery"("id") ON DELETE SET NULL ON UPDATE CASCADE,
FOREIGN KEY ("clubChapterId") REFERENCES "ClubChapter"("id") ON DELETE SET NULL ON UPDATE CASCADE)

CREATE UNIQUE INDEX "quaint"."Club.email" ON "Club"("email")

CREATE UNIQUE INDEX "quaint"."ClubChapter.email" ON "ClubChapter"("email")

CREATE UNIQUE INDEX "quaint"."User.email" ON "User"("email")

PRAGMA "quaint".foreign_key_check;

PRAGMA foreign_keys=ON;
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20200629144603-create-base-table-set
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,175 @@
+datasource DS {
+  provider = "sqlite"
+  url = "***"
+}
+
+generator client {
+  provider      = "prisma-client-js"
+  binaryTargets = env("BINARY_TARGET")
+}
+
+// Define your own datamodels here and run `yarn redwood db save` to create
+// migrations for them.
+model Address {
+  id                        Int           @id @default(autoincrement())
+  street1                   String
+  street2                   String?
+  city                      String
+  state                     String
+  country                   String
+  zipcode                   String
+  clubChapterMailingAddress ClubChapter[] @relation("MailingAddress")
+  clubChapterViewingAddress ClubChapter[] @relation("ViewingAddress")
+  User                      User[]        @relation("UserAddress")
+}
+
+model RoleType {
+  id   Int    @id @default(autoincrement())
+  name String
+  Role Role[]
+}
+
+model Role {
+  id           Int         @id @default(autoincrement())
+  name         String
+  roleTypeId   Int
+  roleType     RoleType    @relation(fields: [roleTypeId])
+  clubChaperId Int
+  clubChapter  ClubChapter @relation(fields: [clubChaperId])
+  User         User?       @relation(fields: [userId], references: [id])
+  userId       Int?
+}
+
+model Media {
+  id             Int           @id @default(autoincrement())
+  filename       String
+  filetype       String
+  description    String?
+  createdAt      DateTime      @default(now())
+  createdById    Int
+  updatedAt      DateTime?     @default(now())
+  updatedById    Int?
+  ClubChapter    ClubChapter[]
+  Club           Club[]
+  User           User[]
+  PhotoGallery   PhotoGallery? @relation(fields: [photoGalleryId], references: [id])
+  photoGalleryId Int?
+  Post           Post[]
+}
+
+model PhotoGallery {
+  id              Int         @id @default(autoincrement())
+  name            String
+  description     String
+  media           Media[]
+  active          Boolean     @default(true)
+  deactivatedAt   DateTime
+  deactivatedById Int?
+  clubChapterId   Int
+  clubChapter     ClubChapter @relation(fields: [clubChapterId])
+  createdAt       DateTime    @default(now())
+  createdById     Int
+  updatedAt       DateTime?   @default(now())
+  updatedById     Int?
+  Post            Post[]
+}
+
+model Club {
+  id          Int           @id @default(autoincrement())
+  email       String        @unique
+  name        String
+  logoId      Int?
+  logo        Media?        @relation(fields: [logoId])
+  league      String
+  createdAt   DateTime      @default(now())
+  createdById Int
+  updatedAt   DateTime?     @default(now())
+  updatedById Int?
+  ClubChapter ClubChapter[]
+}
+
+model Officer {
+  id            Int          @id @default(autoincrement())
+  userId        Int
+  user          User         @relation(fields: [userId])
+  title         String?
+  createdAt     DateTime     @default(now())
+  createdById   Int
+  updatedAt     DateTime?    @default(now())
+  updatedById   Int?
+  ClubChapter   ClubChapter? @relation(fields: [clubChapterId], references: [id])
+  clubChapterId Int?
+}
+
+model ClubChapter {
+  id               Int            @id @default(autoincrement())
+  email            String         @unique
+  name             String
+  clubId           Int
+  club             Club           @relation(fields: [clubId])
+  logoId           Int?
+  logo             Media?         @relation(fields: [logoId])
+  mailAddressId    Int?
+  mailAddress      Address?       @relation("MailingAddress", fields: [mailAddressId])
+  viewingAddressId Int?
+  viewingAddress   Address?       @relation("ViewingAddress", fields: [viewingAddressId])
+  phone            String?
+  facebook         String?
+  twitter          String?
+  instagram        String?
+  active           Boolean        @default(true)
+  deactivatedAt    DateTime
+  deactivatedById  Int?
+  createdAt        DateTime       @default(now())
+  createdById      Int
+  updatedAt        DateTime?      @default(now())
+  updatedById      Int?
+  photoGalleries   PhotoGallery[]
+  officers         Officer[]
+  Role             Role[]
+  members          User[]
+  Post             Post[]
+}
+
+model User {
+  id               Int         @id @default(autoincrement())
+  email            String      @unique
+  firstName        String
+  lastName         String
+  displayName      String?
+  joinedAt         DateTime
+  clubMembershipId String?
+  active           Boolean     @default(true)
+  deactivatedAt    DateTime
+  deactivatedById  Int?
+  clubChapterId    Int
+  clubChapter      ClubChapter @relation(fields: [clubChapterId])
+  addressId        Int?
+  address          Address?    @relation("UserAddress", fields: [addressId])
+  phone            String?
+  imageId          Int?
+  image            Media?      @relation(fields: [imageId])
+  createdAt        DateTime    @default(now())
+  updatedAt        DateTime    @default(now())
+  roles            Role[]
+  Officer          Officer[]
+  Post             Post[]
+}
+
+model Post {
+  id             Int           @id @default(autoincrement())
+  title          String
+  contentBody    String
+  authorId       Int
+  author         User          @relation(fields: [authorId])
+  mediaId        Int?
+  media          Media?        @relation(fields: [mediaId])
+  photoGalleryId Int?
+  photoGallery   PhotoGallery? @relation(fields: [photoGalleryId])
+  ClubChapter    ClubChapter?  @relation(fields: [clubChapterId], references: [id])
+  clubChapterId  Int?
+  createdAt      DateTime      @default(now())
+  createdById    Int
+  updatedAt      DateTime?     @default(now())
+  updatedById    Int?
+}
```


